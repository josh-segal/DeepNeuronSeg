from PyQt5.QtWidgets import (QApplication, QMainWindow, QWidget, QTabWidget, 
                           QVBoxLayout, QHBoxLayout, QLabel, QScrollArea, 
                           QPushButton, QDialog, QFileDialog, QSpinBox, QComboBox,
                        QListWidget, QDoubleSpinBox, 
                           QCheckBox, QLineEdit, QGridLayout, QSizePolicy)
from PyQt5.QtCore import Qt, pyqtSignal, QPoint, QRect, QPointF
from PyQt5.QtGui import QImage, QPixmap, QPainter, QColor, QPen 
from matplotlib.backends.backend_qt5agg import FigureCanvasQTAgg as FigureCanvas
from matplotlib.figure import Figure
import matplotlib.lines as mlines
import sys
from dataclasses import dataclass
from typing import List, Dict, Any
import os
import random
import shutil
from PIL import Image
import numpy as np
import tempfile
from tqdm import tqdm
from itertools import chain
from tinydb import TinyDB, Query


from utils import (get_data, set_data, save_label, get_image_mask_label_tuples, create_yaml, trim_underscores, 
parse_png_label, parse_txt_label, parse_csv_label, parse_xml_label, FrameSelectionDialog)
from inference import segment, composite_mask, mask_to_bboxes, mask_to_polygons
from qa import DetectionQAMetrics
from denoise_model import DenoiseModel